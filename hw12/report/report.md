# 数字图像处理 第12周作业

## Task 1

先使用指数平滑函数 $h(x,y)=\exp(\sqrt{x^2+y^2}/120)$ 卷积产生模糊，然后使用逆滤波进行图像恢复，逆滤波函数采用：
$$
M(u,v)=\begin{cases}\
k, & H(u,v)<d\\
\dfrac{1}{H(u,v)}, & \text{else}
\end{cases}
$$
运行文件 `task1.py` ，得到结果：

![202505111526624](https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/202505111526624.png)

使用逆滤波之后，确实在一定程度上消除模糊、图像变得更加清晰，但是可以发现图像中出现很多横向和纵向的白色条纹，主要是因为退化函数 $H(u,v)$ 在某些点频率值很低，几乎为零，因此频域做除法时，这些频率点会被过度放大，在时域呈现出周期性的、密密麻麻的细条纹和网格。这是已经对逆滤波加了限制之后的结果，如果不加限制，直接进行 $\hat F(u,v)=\dfrac{G(u,v)}{H(u,v)}$ 处理，恢复后的图像将根本无法辨认。经过改进后的逆滤波需要选择一个较为平衡的 $d$ 值，因为如果 $d$ 值较小，高频分量越强，图像失真严重；如果 $d$ 值较大，处理后图像仍较为模糊，复原效果不佳。

## Task 2

在 Task 1 中的得到的模糊图像中添加3种高斯噪声，均值为0，方差分别为 8, 16, 24 。3个图像分别进行逆滤波和维纳滤波。运行文件 `task2.py` ，效果对比如下：

![202505111526566](https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/202505111526566.png)

维纳滤波同样出现了像逆滤波那样的白色细长条纹，但是效果稍好于逆滤波，主要也是因为维纳滤波中 $K$ 值得选取，如果 $K$ 值较小，则对高频率分量抑制效果不佳，条纹和网格越明显；如果 $K$ 值较大，图像仍然模糊，恢复效果不佳。

## Task 3

在原始图像上加入运动模糊，

运行文件 `task3.py` ，效果如下：

![202505111526790](https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/202505111526790.png)

可见，逆滤波和维纳滤波都较好地恢复了运动模糊，但是可以发现图像中竖直方向（也就是之前运动模糊的方向）似乎存在白色的、一些部位运动到别处的残影。原因可能是：在频域进行除法的时候，逆滤波和维纳滤波都会在一定程度上会把一些高频噪声放大（难以找到最合适的参数进行抑制），频域的乘除法对应时域的循环卷积，这些模糊部分会被周期性的搬移到这个方向上，产生残影。

## Task 4

使用最小平方法恢复图像，$\hat F(u,v)=\dfrac{H^*(u，v)}{|H(u,v)|^2+s|P(u,v)|^2}G(u,v)$ 。

运行文件 `task4.py` ，效果如下：

![202505111527874](https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/202505111527874.png)

最小平方法与逆滤波和维纳滤波相比，没有出现在竖直方向上的残影，但是出现了类似之前处理卷积核模糊得到的结果的细小线条和网格。原因可能是拉普拉斯算子频域某些地方值也为0，此时 $s|P(u,v)|^2$ 在分母上相当于不起作用，本应被抑制的高频成分局部放大，加上时域的循环卷积特性，导致出现细小的网格和条纹。
